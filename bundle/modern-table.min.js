class ModernTable { constructor(t, e) { this.container = document.querySelector(t), this.container ? (this.options = { data: [], columns: [], searchPlaceholder: "Search something...", pageSize: 10, pageSizeOptions: [5, 10, 20, 50], showSearch: !0, showColumns: !0, pagination: !0, filters: [], ...e }, this.state = { data: [...this.options.data], filteredData: [...this.options.data], sortKey: null, sortOrder: "asc", currentPage: 1, searchQuery: "", hiddenColumns: new Set, activeFilters: {}, pageSize: this.options.pageSize }, this.options.filters.forEach((t => { this.state.activeFilters[t.field] = new Set })), this.init()) : console.error(`ModernTable: Container ${t} not found.`) } init() { this.container.classList.add("mt-container"), this.dom = { controls: document.createElement("div"), chips: document.createElement("div"), tableWrapper: document.createElement("div"), pagination: document.createElement("div") }, this.dom.controls.className = "mt-controls", this.dom.chips.className = "mt-filter-chips", this.dom.tableWrapper.className = "mt-table-wrapper", this.container.appendChild(this.dom.controls), this.container.appendChild(this.dom.chips), this.container.appendChild(this.dom.tableWrapper), this.container.appendChild(this.dom.pagination), this.renderControls(), this.filterData(), this.render() } render() { this.updateControlsState(), this.renderFilterChips(), this.dom.tableWrapper.innerHTML = ""; const t = document.createElement("table"); t.className = "mt-table", t.appendChild(this.createHeader()), t.appendChild(this.createBody()), this.dom.tableWrapper.appendChild(t), this.renderPagination() } updateControlsState() { this.options.filters.forEach((t => { const e = this.dom.controls.querySelector(`.mt-filter-btn[data-field="${t.field}"]`); if (e) { const s = this.state.activeFilters[t.field].size; e.innerHTML = `${t.title} ${s > 0 ? `(${s})` : ""} <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg> ` } })) } renderControls() { this.dom.controls.innerHTML = ""; const t = document.createElement("div"); if (t.className = "mt-controls-left", this.options.showSearch) { const e = document.createElement("div"); e.className = "mt-search-wrapper", e.setAttribute("style", "display: flex; align-items: center; position: relative;"), e.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="position: absolute; left: 10px;" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0z"/></svg>'; const s = document.createElement("input"); s.type = "text", s.placeholder = this.options.searchPlaceholder, s.className = "mt-input", s.setAttribute("style", "padding-left: 35px;"), s.value = this.state.searchQuery, e.appendChild(s); const n = this.debounce((t => this.handleSearch(t)), 300); s.addEventListener("input", (t => n(t.target.value))), t.appendChild(e) } this.dom.controls.appendChild(t); const e = document.createElement("div"); e.className = "mt-controls-right", this.options.filters.forEach((t => { e.appendChild(this.createFilterDropdown(t)) })), this.options.showColumns && e.appendChild(this.createColumnsDropdown()), this.dom.controls.appendChild(e) } renderFilterChips() { this.dom.chips.innerHTML = ""; const t = this.createFilterChips(); t ? (this.dom.chips.appendChild(t), this.dom.chips.style.display = "flex") : this.dom.chips.style.display = "none" } renderPagination() { if (this.dom.pagination.innerHTML = "", this.options.pagination) { const t = this.createPaginationArea(); this.dom.pagination.appendChild(t) } else this.dom.pagination.style.display = "none" } debounce(t, e) { let s; return function (...n) { clearTimeout(s), s = setTimeout((() => { clearTimeout(s), t(...n) }), e) } } createFilterDropdown(t) { const e = document.createElement("div"); e.className = "mt-dropdown"; const s = this.state.activeFilters[t.field].size, n = document.createElement("button"); n.className = "mt-btn mt-filter-btn", n.setAttribute("data-field", t.field), n.innerHTML = `${t.title} ${s > 0 ? `(${s})` : ""}<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>`, n.addEventListener("click", (t => { t.stopPropagation(), this.closeAllDropdowns(e), e.classList.toggle("active") })); const i = document.createElement("div"); return i.className = "mt-dropdown-content", t.options.forEach((e => { const s = document.createElement("label"); s.className = "mt-dropdown-item"; const n = document.createElement("input"); n.type = "checkbox", n.checked = this.state.activeFilters[t.field].has(e), n.addEventListener("change", (() => this.handleFilterToggle(t.field, e))), s.appendChild(n), s.appendChild(document.createTextNode(e)), i.appendChild(s) })), e.appendChild(n), e.appendChild(i), document.addEventListener("click", (t => { e.contains(t.target) || e.classList.remove("active") })), e } createColumnsDropdown() { const t = document.createElement("div"); t.className = "mt-dropdown"; const e = document.createElement("button"); e.className = "mt-btn", e.innerHTML = '<svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"></path></svg>Columns', e.addEventListener("click", (e => { e.stopPropagation(), this.closeAllDropdowns(t), t.classList.toggle("active") })); const s = document.createElement("div"); return s.className = "mt-dropdown-content", this.options.columns.forEach((t => { const e = document.createElement("label"); e.className = "mt-dropdown-item"; const n = document.createElement("input"); n.type = "checkbox", n.checked = !this.state.hiddenColumns.has(t.field), n.addEventListener("change", (() => this.toggleColumn(t.field))), e.appendChild(n), e.appendChild(document.createTextNode(t.title)), s.appendChild(e) })), t.appendChild(e), t.appendChild(s), document.addEventListener("click", (e => { t.contains(e.target) || t.classList.remove("active") })), t } createFilterChips() { const t = Object.keys(this.state.activeFilters).filter((t => this.state.activeFilters[t].size > 0)); if (0 === t.length) return null; const e = document.createElement("div"); e.className = "mt-filter-chips", t.forEach((t => { const s = this.options.filters.find((e => e.field === t)); this.state.activeFilters[t].forEach((n => { const i = document.createElement("div"); i.className = "mt-chip", i.innerHTML = `<span class="mt-chip-label">${s.title}:</span><span class="mt-chip-value">${n}</span><span class="mt-chip-close">Ã—</span>`, i.querySelector(".mt-chip-close").addEventListener("click", (() => this.handleFilterToggle(t, n))), e.appendChild(i) })) })); const s = document.createElement("a"); return s.className = "mt-clear-filters", s.textContent = "Clear all", s.addEventListener("click", (() => this.handleClearAllFilters())), e.appendChild(s), e } createHeader() { const t = document.createElement("thead"), e = document.createElement("tr"); return this.options.columns.forEach((t => { if (this.state.hiddenColumns.has(t.field)) return; const s = document.createElement("th"), n = document.createElement("div"); if (n.className = "mt-th-content", n.innerHTML = `<span>${t.title}</span>`, !1 !== t.sortable) { s.classList.add("sortable"); const e = document.createElement("div"); e.className = "mt-sort-icon", e.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24"  xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"><polyline points="8 8.333 12 4.333 16 8.333 16 8.333" class="up"></polyline><polyline points="16 15.667 12 19.667 8 15.667 8 15.667" class="down"></polyline> </svg> ', n.appendChild(e), this.state.sortKey === t.field && s.classList.add("asc" === this.state.sortOrder ? "sort-asc" : "sort-desc"), s.addEventListener("click", (() => this.handleSort(t.field))) } s.appendChild(n), e.appendChild(s) })), t.appendChild(e), t } createBody() { const t = document.createElement("tbody"), e = this.getPagedData(); if (0 === e.length) { const e = document.createElement("tr"), s = document.createElement("td"), n = this.options.columns.filter((t => !this.state.hiddenColumns.has(t.field))).length; return s.colSpan = n, s.className = "mt-empty", s.textContent = "No records found matching your filters", e.appendChild(s), t.appendChild(e), t } return e.forEach((e => { const s = document.createElement("tr"); this.options.columns.forEach((t => { if (this.state.hiddenColumns.has(t.field)) return; const n = document.createElement("td"), i = e[t.field]; t.render ? n.innerHTML = t.render(i, e) : n.textContent = i, s.appendChild(n) })), t.appendChild(s) })), t } createPaginationArea() { const t = document.createElement("div"); t.className = "mt-pagination"; const e = document.createElement("div"); e.className = "mt-pagination-info"; const s = document.createElement("span"), n = this.state.filteredData.length > 0 ? (this.state.currentPage - 1) * this.state.pageSize + 1 : 0, i = Math.min(n + this.state.pageSize - 1, this.state.filteredData.length); s.textContent = `Showing ${n} to ${i} of ${this.state.filteredData.length} entries`, e.appendChild(s); const a = document.createElement("select"); a.className = "mt-select", this.options.pageSizeOptions.forEach((t => { const e = document.createElement("option"); e.value = t, e.textContent = `${t} per page`, t === this.state.pageSize && (e.selected = !0), a.appendChild(e) })), a.addEventListener("change", (t => this.handlePageSizeChange(parseInt(t.target.value)))), e.appendChild(a), t.appendChild(e); const r = Math.ceil(this.state.filteredData.length / this.state.pageSize), o = document.createElement("div"); o.className = "mt-pagination-btns"; const l = document.createElement("button"); l.className = "mt-btn mt-page-nav", l.innerHTML = "&laquo;", l.disabled = 1 === this.state.currentPage, l.addEventListener("click", (() => this.setPage(this.state.currentPage - 1))), o.appendChild(l); this.getPaginationRange(this.state.currentPage, r).forEach((t => { if ("..." === t) { const t = document.createElement("span"); t.className = "mt-pagination-ellipsis", t.textContent = "...", o.appendChild(t) } else { const e = document.createElement("button"); e.className = "mt-btn mt-page-btn " + (this.state.currentPage === t ? "active" : ""), e.textContent = t, e.addEventListener("click", (() => this.setPage(t))), o.appendChild(e) } })); const c = document.createElement("button"); return c.className = "mt-btn mt-page-nav", c.innerHTML = "&raquo;", c.disabled = this.state.currentPage === r || 0 === r, c.addEventListener("click", (() => this.setPage(this.state.currentPage + 1))), o.appendChild(c), t.appendChild(o), t } getPaginationRange(t, e) { const s = t - 2, n = t + 2 + 1, i = [], a = []; let r; for (let t = 1; t <= e; t++)(1 === t || t === e || t >= s && t < n) && i.push(t); for (let t of i) r && (t - r == 2 ? a.push(r + 1) : t - r != 1 && a.push("...")), a.push(t), r = t; return a } handleSearch(t) { this.state.searchQuery = t.toLowerCase(), this.state.currentPage = 1, this.filterData(), this.render() } handleFilterToggle(t, e) { this.state.activeFilters[t].has(e) ? this.state.activeFilters[t].delete(e) : this.state.activeFilters[t].add(e), this.state.currentPage = 1, this.filterData(), this.render(), this.renderControls() } handleClearAllFilters() { Object.keys(this.state.activeFilters).forEach((t => this.state.activeFilters[t].clear())), this.state.currentPage = 1, this.filterData(), this.render(), this.renderControls() } handleSort(t) { this.state.sortKey === t ? this.state.sortOrder = "asc" === this.state.sortOrder ? "desc" : "asc" : (this.state.sortKey = t, this.state.sortOrder = "asc"), this.filterData(), this.render() } handlePageSizeChange(t) { this.state.pageSize = t, this.state.currentPage = 1, this.render() } toggleColumn(t) { this.state.hiddenColumns.has(t) ? this.state.hiddenColumns.delete(t) : this.state.hiddenColumns.add(t), this.render() } setPage(t) { this.state.currentPage = t, this.render() } setData(t) { this.options.data = [...t], this.state.data = [...t], this.state.currentPage = 1, this.filterData(), this.render() } filterData() { let t = [...this.options.data]; this.state.searchQuery && (t = t.filter((t => this.options.columns.some((e => { if (!1 === e.searchable) return !1; const s = t[e.field]; return null != s && String(s).toLowerCase().includes(this.state.searchQuery) }))))), Object.keys(this.state.activeFilters).forEach((e => { const s = this.state.activeFilters[e]; s.size > 0 && (t = t.filter((t => s.has(t[e])))) })), this.state.sortKey && t.sort(((t, e) => { const s = t[this.state.sortKey], n = e[this.state.sortKey]; return "string" == typeof s ? "asc" === this.state.sortOrder ? s.localeCompare(n) : n.localeCompare(s) : s < n ? "asc" === this.state.sortOrder ? -1 : 1 : s > n ? "asc" === this.state.sortOrder ? 1 : -1 : 0 })), this.state.filteredData = t } getPagedData() { if (!this.options.pagination) return this.state.filteredData; const t = (this.state.currentPage - 1) * this.state.pageSize; return this.state.filteredData.slice(t, t + this.state.pageSize) } closeAllDropdowns(t) { document.querySelectorAll(".mt-dropdown").forEach((e => { e !== t && e.classList.remove("active") })) } }